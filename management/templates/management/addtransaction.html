{% extends 'management/base.html' %}

{% block title %}Add Transaction{% endblock %}

{% block content %}

<div class="form-wrapper">
    <div class="form-header">
        <h2>Issue New Book</h2>
    </div>

    {% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="alert {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    </div>
    {% endif %}

    <form method="post" class="styled-form">
        {% csrf_token %}

        <div class="form-group">
            <label for="customer">Customer:</label>
            <select id="customer" name="customer" class="form-select" required>
                <option value="">-- Choose a Customer --</option>
                {% for customer in customers %}
                    <option value="{{ customer.customer_id }}">{{ customer.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="book">Book:</label>
            <select id="book" name="book" class="form-select" required>
                <option value="">-- Choose a Book --</option>
                {% for book in books %}
                    {% if book.quantity > 0 %}
                        <option value="{{ book.book_id }}">
                            {{ book.name }} ({{ book.quantity }} available)
                        </option>
                    {% endif %}
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="issue_date">Issue Date:</label>
            <input type="date" name="issue_date" id="issue_date" class="form-input" value="{{ today|date:'Y-m-d' }}" required>
        </div>

        <div class="form-group">
            <label for="return_date">Expected Return Date (optional):</label>
            <input type="date" name="return_date" id="return_date" class="form-input">
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Create Transaction</button>
        </div>
    </form>
</div>

{% endblock %}
